USE IQVIA_IC
GO

IF OBJECT_ID('TEMPDB..#ESTRUTURA_ORGANIZACIONAL') IS NOT NULL DROP TABLE #ESTRUTURA_ORGANIZACIONAL

CREATE TABLE #ESTRUTURA_ORGANIZACIONAL
(
	MATRICULA_VENDEDOR	VARCHAR(4) NOT NULL,
	MATRICULA_GERENTE	VARCHAR(4) NOT NULL,
	GRADE_DE_PRODUTO	VARCHAR(20) NOT NULL
)

INSERT INTO #ESTRUTURA_ORGANIZACIONAL (MATRICULA_VENDEDOR, MATRICULA_GERENTE, GRADE_DE_PRODUTO) VALUES
('0001', '0019', 'GRADE - TIPO 1'), 
('0002', '0019', 'GRADE - TIPO 1'), 
('0003', '0019', 'GRADE - TIPO 1'), 
('0004', '0019', 'GRADE - TIPO 1'), 
('0005', '0019', 'GRADE - TIPO 1'), 
('0006', '0019', 'GRADE - TIPO 1'), 
('0007', '0019', 'GRADE - TIPO 1'), 
('0008', '0019', 'GRADE - TIPO 1'), 
('0009', '0019', 'GRADE - TIPO 1'), 
('0010', '0019', 'GRADE - TIPO 1'), 
('0011', '0019', 'GRADE - TIPO 1'), 
('0012', '0019', 'GRADE - TIPO 1'), 
('0013', '0019', 'GRADE - TIPO 1'), 
('0014', '0019', 'GRADE - TIPO 1'), 
('0015', '0019', 'GRADE - TIPO 1'), 
('0016', '0019', 'GRADE - TIPO 1'), 
('0017', '0019', 'GRADE - TIPO 1'), 
('0018', '0019', 'GRADE - TIPO 1'),

('0020', '0030', 'GRADE - TIPO 2'),
('0021', '0030', 'GRADE - TIPO 2'),
('0022', '0030', 'GRADE - TIPO 2'),
('0023', '0030', 'GRADE - TIPO 2'),
('0024', '0030', 'GRADE - TIPO 2'),
('0025', '0030', 'GRADE - TIPO 2'),
('0026', '0030', 'GRADE - TIPO 2'),
('0027', '0030', 'GRADE - TIPO 2'),
('0028', '0030', 'GRADE - TIPO 2'),
('0029', '0030', 'GRADE - TIPO 2'),

('0031', '0037', 'GRADE - TIPO 3'),
('0032', '0037', 'GRADE - TIPO 3'),
('0033', '0037', 'GRADE - TIPO 3'),
('0034', '0037', 'GRADE - TIPO 3'),
('0035', '0037', 'GRADE - TIPO 3'),
('0036', '0037', 'GRADE - TIPO 3'),

('0038', '0047', 'GRADE - TIPO 4'),
('0039', '0047', 'GRADE - TIPO 4'),
('0040', '0047', 'GRADE - TIPO 4'),
('0041', '0047', 'GRADE - TIPO 4'),
('0042', '0047', 'GRADE - TIPO 4'),
('0043', '0047', 'GRADE - TIPO 4'),
('0044', '0047', 'GRADE - TIPO 4'),
('0045', '0047', 'GRADE - TIPO 4'),
('0046', '0047', 'GRADE - TIPO 4'),

('0048', '0054', 'GRADE - TIPO 5'),
('0049', '0054', 'GRADE - TIPO 5'),
('0050', '0054', 'GRADE - TIPO 5'),
('0051', '0054', 'GRADE - TIPO 5'),
('0052', '0054', 'GRADE - TIPO 5'),
('0053', '0054', 'GRADE - TIPO 5')

INSERT INTO ESTRUTURA (ID_VENDEDOR, ID_GERENTE,	CODIGO_GRADE_PRODUTO)
SELECT B.ID_FUNCIONARIO, C.ID_FUNCIONARIO, A.GRADE_DE_PRODUTO 
  FROM #ESTRUTURA_ORGANIZACIONAL A
  JOIN FUNCIONARIO B
    ON A.MATRICULA_VENDEDOR = B.MATRICULA
  JOIN FUNCIONARIO C
    ON A.MATRICULA_GERENTE = C.MATRICULA

IF OBJECT_ID('TEMPDB..#ESTRUTURA_ORGANIZACIONAL') IS NOT NULL DROP TABLE #ESTRUTURA_ORGANIZACIONAL